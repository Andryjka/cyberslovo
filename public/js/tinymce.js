$(document).ready(function(){tinymce.PluginManager.add("twitter_url",function(t,e){t.on("init",function(t){o=t.target.id}),t.addButton("twitter_url",{text:"Twitter",icon:!1,onclick:function(){t.windowManager.open({title:"Twitter Embed",body:[{type:"textbox",size:40,height:"100px",name:"twitter",label:"Ссылка на твит"}],onsubmit:function(t){var e=t.data.twitter;$.ajax({url:"https://publish.twitter.com/oembed?url="+e,dataType:"jsonp",async:!1,success:function(t){tinyMCE.activeEditor.insertContent('<div class="div_border" contenteditable="false">'+t.html+"</div>")},error:function(t,e){var n="";n=0===t.status?"Not connect.\n Verify Network.":404==t.status?"Requested page not found. [404]":500==t.status?"Internal Server Error [500].":"parsererror"===e?"Requested JSON parse failed.":"timeout"===e?"Time out error.":"abort"===e?"Ajax request aborted.":"Uncaught Error.\n"+t.responseText,alert(n)}}),setTimeout(function(){iframe.contentWindow.twttr.widgets.load()},1e3)}})}})});var o="";tinymce.PluginManager.add("instagram",function(t,e){t.addButton("instagram",{text:"Instagram",icon:!1,onclick:function(){t.windowManager.open({title:"Instagram Embed",body:[{type:"textbox",size:40,height:"100px",name:"instagram",label:"Embed code"}],onsubmit:function(t){var e=t.data.instagram.match(/<script.*<\/script>/)[0].match(/".*\.js/)[0].split('"')[1],n=document.createElement("script");n.setAttribute("src",e),n.setAttribute("type","text/javascript");var i=document.getElementById(o+"_ifr"),a=i.contentWindow.document.getElementsByTagName("head")[0];tinyMCE.activeEditor.insertContent(t.data.instagram),a.appendChild(n),setTimeout(function(){i.contentWindow.instgrm.Embeds.process()},1e3)}})}})}),tinymce.init({selector:"textarea#description, textarea#other",height:300,theme:"modern",menubar:!0,plugins:"advlist paste wordcount fullscreen lists link image preview code media twitter_url instagram", mobile: { theme: 'mobile' }, toolbar:"bold italic | formatselect | block | removeformat | blockquote | numlist bullist | link image media | alignleft aligncenter alignright alignjustify | indent outdent | undo redo | code preview | twitter_url instagram |", paste_as_text: true, valid_elements:"+*[*]",image_caption:!0,extended_valid_elements:"+iframe[width|height|name|align|class|frameborder|allowfullscreen|allow|src|*],script[language|type|async|src|charset]img[*]embed[width|height|name|flashvars|src|bgcolor|align|play|loop|quality|allowscriptaccess|type|pluginspage]blockquote[dir|style|cite|class|id|lang|onclick|ondblclick|onkeydown|onkeypress|onkeyup|onmousedown|onmousemove|onmouseout|onmouseover|onmouseup|title]",content_css:["//fonts.googleapis.com/css?family=Lato:300,300i,400,400i"],setup:function(t){t.on("init",function(t){o=t.target.id})}})});